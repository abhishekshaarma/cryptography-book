\chapter{Euclidean algorithm -- GCD}
\begin{python0}
from solutions import *; clear()
\end{python0}
% Euclidean Algorithm - GCD

\textbf{GCD Calculation via Euclidean Property}

Given Euclidean property: $a = bq + r, 0 \leq r < b$

\textbf{GCD Lemma}: If $a = bq + r$, then $\gcd(a, b) = \gcd(b, r)$

\textbf{Proof}:
Let $d$ be any common divisor of $a$ and $b$. 
Then $d \mid a$ and $d \mid b$, so $d \mid (a - bq) = r$.
Thus, $d$ is also a common divisor of $b$ and $r$.

Conversely, if $d$ is a common divisor of $b$ and $r$,
then $d \mid b$ and $d \mid r$, so $d \mid (bq + r) = a$.
Thus, $d$ is also a common divisor of $a$ and $b$.

Since common divisors of $(a,b)$ and $(b,r)$ are identical,
$\gcd(a,b) = \gcd(b,r)$.

\textbf{Euclidean Algorithm}:
\begin{verbatim}
ALGORITHM: GCD
INPUTS: a, b
OUTPUT: gcd(a, b)
if b == 0:
    return a
else:
    return GCD(b, a % b)
\end{verbatim}

\textbf{Example}: $\gcd(514, 24)$
\begin{align}
\gcd(514, 24) &= \gcd(24, 514 \bmod 24) = \gcd(24, 10)\\
&= \gcd(10, 24 \bmod 10) = \gcd(10, 4)\\
&= \gcd(4, 10 \bmod 4) = \gcd(4, 2)\\
&= \gcd(2, 4 \bmod 2) = \gcd(2, 0)\\
&= 2
\end{align}

\textbf{LamÃ©'s Theorem (1844)}: Let $a > b > 0$. If Euclidean algorithm takes $n$ steps to compute $\gcd(a,b)$, then:
1. $a \geq F_{n+2}$ and $b \geq F_{n+1}$, where $F_n$ is the $n$-th Fibonacci number
2. $n$ is at most 5 times the number of digits in $b$

\textbf{Proof Sketch}:
(a) By induction: If Euclidean algorithm takes $n$ steps, then:
\begin{align}
a &\geq F_{n+2}\\
b &\geq F_{n+1}
\end{align}

(b) Since $b \geq F_{n+1} \geq \phi^{n-1}$ (where $\phi = \frac{1+\sqrt{5}}{2}$),
$\log_\phi b \geq n-1$, so $n \leq 5\log_{10} b + 1 \leq 5\lfloor\log_{10} b + 1\rfloor$

Result: Number of steps $\leq 5 \times$ number of digits in $b$.

\textbf{Proposition}: Number of digits in $b$ is $\lfloor\log_{10} b + 1\rfloor$

\textbf{Solutions to Exercises}:

\textbf{Exercise 2.6.3} - Compute using Euclidean Algorithm:

(a) $\gcd(10, 1)$
\begin{align}
\gcd(10, 1) &= \gcd(1, 10 \bmod 1) = \gcd(1, 0) = 1
\end{align}

(b) $\gcd(10, 10)$
\begin{align}
\gcd(10, 10) &= \gcd(10, 0) = 10
\end{align}

(c) $\gcd(107, 5)$
\begin{align}
\gcd(107, 5) &= \gcd(5, 107 \bmod 5) = \gcd(5, 2)\\
&= \gcd(2, 5 \bmod 2) = \gcd(2, 1)\\
&= \gcd(1, 2 \bmod 1) = \gcd(1, 0) = 1
\end{align}

(d) $\gcd(107, 26)$
\begin{align}
\gcd(107, 26) &= \gcd(26, 107 \bmod 26) = \gcd(26, 3)\\
&= \gcd(3, 26 \bmod 3) = \gcd(3, 2)\\
&= \gcd(2, 3 \bmod 2) = \gcd(2, 1)\\
&= \gcd(1, 2 \bmod 1) = \gcd(1, 0) = 1
\end{align}

(e) $\gcd(84, 333)$
\begin{align}
\gcd(84, 333) &= \gcd(333, 84) \quad \text{(swap for $a \geq b$)}\\
&= \gcd(84, 333 \bmod 84) = \gcd(84, 81)\\
&= \gcd(81, 84 \bmod 81) = \gcd(81, 3)\\
&= \gcd(3, 81 \bmod 3) = \gcd(3, 0) = 3
\end{align}

\textbf{Exercise 2.6.4} - Compute and simplify:

(a) $\gcd(ab, b)$
\begin{align}
\gcd(ab, b) &= \gcd(b, ab \bmod b) = \gcd(b, 0) = b
\end{align}

(b) $\gcd(a, a+1)$
\begin{align}
\gcd(a, a+1) &= \gcd(a+1, a \bmod (a+1)) = \gcd(a+1, a)\\
&= \gcd(a, a+1 \bmod a) = \gcd(a, 1)\\
&= \gcd(1, a \bmod 1) = \gcd(1, 0) = 1
\end{align}

(c) $\gcd(ab+a, b)$ where $0 < a < b$
\begin{align}
\gcd(ab+a, b) &= \gcd(b, (ab+a) \bmod b)\\
&= \gcd(b, a) \quad \text{(since $(ab+a) \bmod b = a$)}
\end{align}

(d) $\gcd(a(a+1)+a, a+1)$ where $0 < a < a+1$
\begin{align}
\gcd(a(a+1)+a, a+1) &= \gcd(a+1, (a(a+1)+a) \bmod (a+1))\\
&= \gcd(a+1, a(a+1) \bmod (a+1) + a \bmod (a+1))\\
&= \gcd(a+1, 0 + a) = \gcd(a+1, a)\\
&= \gcd(a, a+1 \bmod a) = \gcd(a, 1)\\
&= \gcd(1, a \bmod 1) = \gcd(1, 0) = 1
\end{align}

(e) $\gcd(1+x+\dots+x^n, x)$
\begin{align}
\gcd(1+x+\dots+x^n, x) &= \gcd(x, (1+x+\dots+x^n) \bmod x)\\
&= \gcd(x, 1) \quad \text{(since $x$ divides $x+x^2+\dots+x^n$)}\\
&= \gcd(1, x \bmod 1) = \gcd(1, 0) = 1
\end{align}

(f) $\gcd(F_{10}, F_{11})$ where $F_n$ is the Fibonacci sequence

Using the Fibonacci recursion $F_{n+2} = F_{n+1} + F_n$, we have:
$F_{11} = F_{10} + F_9$, so $F_9 = F_{11} - F_{10}$

\begin{align}
\gcd(F_{10}, F_{11}) &= \gcd(F_{11}, F_{10} \bmod F_{11})\\
&= \gcd(F_{11}, F_{10})\\
&= \gcd(F_{10}, F_{11} \bmod F_{10})\\
&= \gcd(F_{10}, F_9) \quad \text{(since $F_{11} \bmod F_{10} = F_9$)}
\end{align}

Continuing this pattern:
$\gcd(F_{10}, F_9) = \gcd(F_9, F_8) = \cdots = \gcd(F_2, F_1) = \gcd(1, 1) = 1$

Thus, $\gcd(F_{10}, F_{11}) = 1$

More generally, $\gcd(F_n, F_{n+1}) = 1$ for any $n \geq 1$.

\textbf{Exercise 2.6.6} - Number of subarrays with GCD equal to k:

Approach:
1. For each start index $i$, compute the running GCD of elements from index $i$ to index $j$.
2. Count how many times this running GCD equals $k$.
\begin{verbatim}
def subarrayGCD(nums, k):
    count = 0
    n = len(nums)
    
    for i in range(n):
        # Initialize gcd as the first element in current subarray
        current_gcd = nums[i]
        
        # If this single element equals k, count it
        if current_gcd == k:
            count += 1
            
        # Try expanding subarray by adding elements
        for j in range(i+1, n):
            # Update running GCD
            current_gcd = math.gcd(current_gcd, nums[j])
            
            # If GCD equals k, count this subarray
            if current_gcd == k:
                count += 1
                
            # If GCD becomes less than k, no need to continue
            # as adding more elements can't increase GCD
            if current_gcd < k:
                break
                
    return count
```
\end{verbatim}

\textbf{Exercise 2.6.7} - GCD Sort:
Problem: Can we sort an array by only swapping pairs where gcd > 1?

Solution: We need to determine if elements can be moved to their correct sorted positions.

Key insight: Elements that share factors > 1 can be connected, forming "connected components".
Elements in the same component can be rearranged freely.

\begin{verbatim}
def gcdSort(nums):
    Find maximum value to set up DSU
    max_val = max(nums)
    
    Create DSU for potential values
    parent = list(range(max_val + 1))
    
    def find(x):
        if parent[x] != x:
            parent[x] = find(parent[x])
        return parent[x]
    
    def union(x, y):
        parent[find(x)] = find(y)
    
    Step 1: Connect numbers with their prime factors
    for num in nums:
        temp = num
        # Try potential factors from 2 to sqrt(num)
        i = 2
        while i * i <= temp:
            if temp % i == 0:
                # Union num with its factor i
                union(num, i)
                while temp % i == 0:
                    temp //= i
            i += 1
         If temp > 1, it's a prime factor
        if temp > 1:
            union(num, temp)
    
     Step 2: Check if sorted array can be achieved
    sorted_nums = sorted(nums)
    for i in range(len(nums)):
        if find(nums[i]) != find(sorted_nums[i]):
            return False
    
    return True
```

\end{verbatim}
%\input{exercises/nt-08/main.tex}
%\input{exercises/nt-09/main.tex}
%\input{exercises/nt-10/main.tex}
\begin{enumerate}
\item[202.5.1]
\begin{enumerate}
\item $\gcd(0, 10)$: Since one number is 0, $\gcd(0, 10) = 10$

\item $\gcd(10, 0)$: Since one number is 0, $\gcd(10, 0) = 10$

\item $\gcd(10, 1)$: Since one number is 1, $\gcd(10, 1) = 1$

\item $\gcd(10, 10)$: When numbers are equal, $\gcd(10, 10) = 10$

\item $\gcd(107, 5)$:
$107 = 5 \cdot 21 + 2$
$5 = 2 \cdot 2 + 1$
$2 = 1 \cdot 2 + 0$
Therefore, $\gcd(107, 5) = 1$

\item $\gcd(107, 26)$:
$107 = 26 \cdot 4 + 3$
$26 = 3 \cdot 8 + 2$
$3 = 2 \cdot 1 + 1$
$2 = 1 \cdot 2 + 0$
Therefore, $\gcd(107, 26) = 1$

\item $\gcd(84, 333)$:
$333 = 84 \cdot 3 + 81$
$84 = 81 \cdot 1 + 3$
$81 = 3 \cdot 27 + 0$
Therefore, $\gcd(84, 333) = 3$

\item $\gcd(F_{10}, F_{11})$:
$F_{10} = 55$, $F_{11} = 89$
$89 = 55 \cdot 1 + 34$
$55 = 34 \cdot 1 + 21$
$34 = 21 \cdot 1 + 13$
$21 = 13 \cdot 1 + 8$
$13 = 8 \cdot 1 + 5$
$8 = 5 \cdot 1 + 3$
$5 = 3 \cdot 1 + 2$
$3 = 2 \cdot 1 + 1$
$2 = 1 \cdot 2 + 0$
Therefore, $\gcd(F_{10}, F_{11}) = 1$

\item $\gcd(ab, b)$:
$ab = b \cdot a + 0$
Therefore, $\gcd(ab, b) = b$

\item $\gcd(a, a+1)$:
$a+1 = a \cdot 1 + 1$
$a = 1 \cdot a + 0$
Therefore, $\gcd(a, a+1) = 1$

\item $\gcd(ab+a, b)$ where $0 < a < b$:
$ab+a = b \cdot a + a = a(b+1)$
$\gcd(a(b+1), b) = \gcd(a, b) \cdot \gcd(b+1, b) = \gcd(a, b) \cdot 1 = \gcd(a, b)$
Therefore, $\gcd(ab+a, b) = \gcd(a, b)$

\item $\gcd(a(a+1)+a, a+1)$ where $0 < a$:
$a(a+1)+a = a(a+1+1) = a(a+2)$
$\gcd(a(a+2), a+1) = \gcd(a, a+1) \cdot \gcd(a+2, a+1) = 1 \cdot 1 = 1$
Therefore, $\gcd(a(a+1)+a, a+1) = 1$
\end{enumerate}
\end{enumerate}
