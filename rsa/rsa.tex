\section{RSA}
RSA is one of the most important encryption algorithms. We work with integers. A message in its real form is just bits, which we view as an integer $x$.

\begin{enumerate}
  \item Alice wants to send a message, which we represent by the integer $x$.
  \item Bob selects two prime numbers $p$ and $q$, and computes
  \[
    N = p\,q.
  \]
  \item He computes $\phi(N) = (p-1)(q-1)$ and chooses integers $e$ and $d$ such that
  \[
    e\,d \equiv 1 \pmod{\phi(N)}.
  \]
  \item Bob publishes the public key $(N,e)$ and keeps the private key $(N,d)$ secret.
  \item Encryption: Alice computes
  \[
    c = E_{N,e}(x) = x^e \bmod N.
  \]
  \item Decryption: Bob computes
  \[
    x = D_{N,d}(c) = c^d \bmod N.
  \]
\end{enumerate}

Why RSA Works

\textbf{Theorem.} Let $p$ and $q$ be primes, let $N = p\,q$, and let $e,d$ satisfy $e\,d \equiv 1 \pmod{\phi(N)}$. Then
\[
  (x^e)^d \equiv x \pmod{N}
\]
for all integers $x$.

\textit{Proof.} Since $e\,d = 1 + k\,\phi(N)$ for some integer $k$, we have
\[
  (x^e)^d = x^{ed} = x^{1+k\,\phi(N)} = x \cdot \bigl(x^{\phi(N)}\bigr)^k.
\]
If $\gcd(x,N)=1$, Euler's theorem gives $x^{\phi(N)} \equiv 1 \pmod{N}$, so the right side is congruent to $x$. If $\gcd(x,N)\neq1$, then $p\mid x$ or $q\mid x$ (or both). In either case $(x^e)^d \equiv 0 \equiv x$ modulo that prime. The conclusion follows by the Chinese remainder theorem.

Hybrid Encryption

In practice, RSA is too slow for large messages. Instead, one uses a hybrid approach:
\begin{enumerate}
  \item Generate a random symmetric key $k$.
  \item Encrypt $k$ with RSA: $c = k^e \bmod N$.
  \item Encrypt the message $M$ with a fast symmetric cipher using key $k$.
  \item Send $(c, \text{Encrypted}(M))$.
\end{enumerate}

\section*{Divisibility Proposition}

Proposition
\begin{enumerate}
  \item If $p$ and $q$ are distinct primes with $p\mid a$ and $q\mid a$, then $p\,q \mid a$.
  \item If $x\mid a$ and $y\mid a$ with $\gcd(x,y)=1$, then $x\,y \mid a$.
  \item If $x\mid a$ and $y\mid a$, then $\tfrac{x\,y}{\gcd(x,y)} \mid a$.
\end{enumerate}

\textit{Proof.}
\begin{enumerate}
  \item Since $p\mid a$, write $a=p\,k$. Then $q\mid a$ implies $q\mid p\,k$. Since $q$ is prime and $q\neq p$, $q\mid k$, so $k=q\,m$ and $a=p(q\,m)=(p\,q)\,m$.
  \item Similar to part 1, using Euclid's lemma.
  \item Let $g=\gcd(x,y)$ and write $x=g x'$, $y=g y'$ with $\gcd(x',y')=1$. Using parts 1 and 2, one shows $\tfrac{xy}{g}\mid a$.
\end{enumerate}

\input{exercises/rsa-14/main.tex}
