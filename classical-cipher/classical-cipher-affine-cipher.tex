\sectionthree{Affine cipher}
\begin{python0}
from solutions import *; clear()
\end{python0}




Suppose we use $\mathbb{Z}/26$ instead of $a$ to $z$. For the shift cipher, we have
\[
E(k,x) = x + k \bmod 26,\quad
D(k,x) = x - k \bmod 26.
\]
We can think of these shifts in terms of numbers where the alphabets represent the numbers. This way we can use different mathematical operations on top of these numbers to create formulas and new algorithms for encryption and decryption.

The Affine Cipher looks something like this:
\[
E(a,b,x) = a x + b \bmod 26.
\]
This increases the key from just $k$ to the pair $(a,b)$, so more effort is required to break the cipher.

Key Features
\begin{itemize}
  \item Key becomes a pair $(a,b)$ instead of a single shift.
  \item Security relies on $a$ being coprime with 26.
  \item $b$ can be any integer modulo 26.
\end{itemize}

\subsection*{Decryption Function}

We want
\[
D((a,b),E((a,b),x)) = x \pmod{26}.
\]
Assume
a decryption of the form
\[
D((a,b),y) = c\,y + d \bmod 26.
\]
Then
\[
c(ax + b) + d \equiv x \pmod{26},
\]
which gives two conditions:
\[
\begin{aligned}
  c\,a &\equiv 1 \pmod{26}, \\
  c\,b + d &\equiv 0 \pmod{26}.
\end{aligned}
\]

The first condition holds when $c = a^{-1} \pmod{26}$, which requires $\gcd(a,26)=1$. The valid values for $a$ are
\[
1,3,5,7,9,11,15,17,19,21,23,25.
\]
Once $c$ is known, we solve the second condition for $d$:
\[
  d \equiv -c\,b \pmod{26}.
\]
Hence the decryption function simplifies to
\[
D((a,b),x) = a^{-1}(x - b) \bmod 26.
\]

\input{exercises/exercise-30/main.tex}




\input{exercises/exercise-31/main.tex}


\input{exercises/exercise-33/main.tex}

\input{exercises/affine-0/main.tex}


\input{exercises/affine-1/main.tex}
\input{exercises/affine-2/main.tex}
\input{exercises/affine-3/main.tex}
\begin{enumerate}
\item[1.6.1]
For $ca \equiv 1 \pmod{26}$:
When $a = 1$: $c = 1$
When $a = 2$: $c = 13$
When $a = 3$: $c = 9$
When $a = 4$: No solution (not coprime to 26)
When $a = 5$: $c = 21$
Solution exists iff $\gcd(a,26) = 1$.

\item[1.6.2]
Numbers coprime to 26 in $\{0,1,...,25\}$: $\{1,3,5,7,9,11,15,17,19,21,23,25\}$
Total: 12 integers have multiplicative inverses mod 26.

\item[1.6.3]
Affine cipher key space: 12 choices for $a$ Ã— 26 choices for $b$ = 312 possible keys.
Worst case for Eve: 312 attempts.
Compared to shift cipher's 26 keys, affine cipher key space is 12 times larger.

\item[1.6.4]
$\phi(26) = 12$ (count of integers coprime to 26)
$\phi(26) \cdot 26 = 12 \cdot 26 = 312$

\item[1.6.6]
Given:
$Aa + b = B$
$Ca + b = D$

Solution:
$a = \frac{D - B}{C - A}$ (when $C \neq A$)
$b = \frac{BC - AD}{C - A}$
\end{enumerate}
